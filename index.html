<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>polimiru | æ”¿æ²»ã‚’å¯è¦–åŒ–ã™ã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- CSSãƒ•ã‚©ãƒ«ãƒ€ã‚’è¦‹ã‚‹ã‚ˆã†ã«æŒ‡å®š -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚¨ãƒªã‚¢ -->
    <div class="platform-hero">
        <h1>æ”¿æ²»ã‚’ã€ã‚‚ã£ã¨é€æ˜ã«ã€‚</h1>
        <p>ã€Œè¨€ã£ãŸã“ã¨ã€ã¨ã€Œã‚„ã£ãŸã“ã¨ã€ã®ã‚®ãƒ£ãƒƒãƒ—ã‚’å¯è¦–åŒ–ã™ã‚‹ã€‚<br>æ—¥æœ¬æœ€å¤§ç´šã®æ”¿æ²»å®¶ãƒ•ã‚¡ã‚¯ãƒˆãƒã‚§ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€‚</p>
        
        <div class="search-dummy">ğŸ” é¸æŒ™åŒºã‚„æ”¿æ²»å®¶ã®åå‰ã§æ¤œç´¢...</div>

        <!-- ã‚¨ãƒªã‚¢è¨­å®šãƒœã‚¿ãƒ³ -->
        <div class="hero-actions">
            <button id="area-btn" class="area-select-btn hero-btn">
                <i class="fa-solid fa-location-dot"></i> <span>ã‚¨ãƒªã‚¢æœªè¨­å®š</span>
            </button>
        </div>
    </div>

    <div class="container">
        
        <!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
        <div class="filter-tabs">
            <button class="filter-btn active" onclick="filterElections('all')">ğŸ”¥ æ³¨ç›®</button>
            <button class="filter-btn" onclick="filterElections('national')">ğŸ›ï¸ å›½æ”¿</button>
            <button class="filter-btn" onclick="filterElections('local')">ğŸ—¾ åœ°æ–¹</button>
        </div>

        <!-- ã‚«ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´æ‰€ -->
        <div class="election-grid" id="election-grid"></div>
    </div>

    <!-- â˜…ã“ã“ãŒä¿®æ­£ãƒã‚¤ãƒ³ãƒˆï¼ js/ ã‚’ã¤ã‘ã¦ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­ã‚’æŒ‡å®š -->
    <script src="js/elections.js"></script>
    <script src="js/layout.js?v=3"></script>

    <!-- è‡ªå‹•ä¸¦ã³æ›¿ãˆï¼†è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯ -->
    <script>
        const grid = document.getElementById('election-grid');
        const savedAreaName = localStorage.getItem('my_area_name') || "";

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã¯ã€Œã™ã¹ã¦ï¼ˆæ³¨ç›®ï¼‰ã€ã‚’è¡¨ç¤º
        renderCards('all');

        // --- 1. ã‚¿ãƒ–ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹æ©Ÿèƒ½ ---
        function filterElections(category) {
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderCards(category);
        }

        // --- 2. ã‚«ãƒ¼ãƒ‰ã‚’æç”»ã™ã‚‹æ©Ÿèƒ½ ---
        function renderCards(category) {
            // ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã‚ã¦ã„ãªã„å ´åˆã®å®‰å…¨ç­–
            if (typeof elections === 'undefined') {
                console.error("electionsãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“");
                return;
            }

            grid.innerHTML = ""; // ãƒªã‚»ãƒƒãƒˆ

            // ãƒ‡ãƒ¼ã‚¿ã®çµã‚Šè¾¼ã¿
            let filteredData = elections;
            
            if (category === 'national') {
                filteredData = elections.filter(e => e.category === 'national');
            } else if (category === 'local') {
                filteredData = elections.filter(e => e.category === 'local');
            } else {
                filteredData = elections; 
            }

            // ä¸¦ã³æ›¿ãˆï¼ˆå±…ä½åœ°å„ªå…ˆï¼‰
            filteredData.sort((a, b) => {
                const isAMatch = savedAreaName.includes(a.prefecture);
                const isBMatch = savedAreaName.includes(b.prefecture);
                if (isAMatch && !isBMatch) return -1;
                if (!isAMatch && isBMatch) return 1; 
                return 0; 
            });

            // è¡¨ç¤º
            filteredData.forEach(election => {
                const badgeClass = election.badgeType === 'national' ? 'badge-national' : 'badge-local';
                const statusClass = election.status.includes('æ³¨ç›®') ? 'status-active' : '';
                const highlightStyle = savedAreaName.includes(election.prefecture) ? 'border: 2px solid #1a2e45; box-shadow: 0 0 15px rgba(26, 46, 69, 0.2);' : '';

                const html = `
                <a href="${election.url}" class="election-card" style="${highlightStyle}">
                    <div class="card-thumb" style="background-image: url('${election.image}');">
                        <span class="badge ${badgeClass}">${election.prefecture}</span>
                        <span class="status-label ${statusClass}">${election.status}</span>
                    </div>
                    <div class="card-content">
                        <div class="election-title">${election.title}</div>
                        <span class="election-date">ğŸ“… ${election.date}</span>
                        <div class="election-desc">${election.desc}</div>
                    </div>
                </a>
                `;
                grid.insertAdjacentHTML('beforeend', html);
            });
        }
    </script>
</body>
</html>